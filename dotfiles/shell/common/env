# shellcheck shell=sh

# https://www.freedesktop.org XDG ENV variable declarations
export XDG_CACHE_HOME=${XDG_CACHE_HOME:-"${HOME}/.cache"}
export XDG_CONFIG_HOME=${XDG_CONFIG_HOME:-"${HOME}/.config"}
export XDG_DATA_HOME=${XDG_DATA_HOME:-"${HOME}/.local/share"}
export XDG_CONFIG_DIRS=${XDG_CONFIG_DIRS:-"/etc/xdg"}
export XDG_DATA_DIRS=${XDG_DATA_DIRS:-"/usr/local/share/:/usr/share/"}
export XDG_RUNTIME_DIR=${XDG_RUNTIME_DIR:-""}

# System env "normalization"
# set HOSTNAME, if not set
[ -z "${HOSTNAME-}" ] && export HOSTNAME=$(uname -n)
# set USER, if not set
[ -z "${USER-}" ] && export USER=$(whoami)
# set OSTYPE, if not set
[ -z "${OSTYPE-}" ] && export OSTYPE="$(uname -s)$(uname -r)"
# set OS_NAME, if not set
case ${OS_NAME:-$(uname -s)} in
  CYGWIN*)
    export IS_WINDOWS=1
    export OS_NAME="windows"
    ;;
  Darwin*)
    export IS_MACOS=1
    export OS_NAME="macos"
    ;;
  Linux*)
    export IS_LINUX=1
    export OS_NAME="linux"
    ;;
  MINGW*)
    export IS_WINDOWS=1
    export OS_NAME="windows"
    ;;
esac

# We need to set $ENV so that if you use shell X as your login shell,
# and then start "sh" as a non-login interactive shell the startup scripts will
# correctly run.
export ENV="${XDG_CONFIG_HOME}"/shell/sh/interactive

# We also need to set BASH_ENV, which is run for *non-interactive* shells.
# (unlike $ENV, which is for interactive shells)
export BASH_ENV="${XDG_CONFIG_HOME}"/shell/bash/env

# shellcheck source=./env_functions
. "${XDG_CONFIG_HOME}"/shell/common/env_functions

# umask 0077
umask 0027

# allow for local overrides
ssource "${XDG_CONFIG_HOME}"/shell/common/env_local
